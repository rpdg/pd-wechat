!function(e,t,r){function n(e,t){return!!e&&e.hasOwnProperty(t)}function i(e,t,r,a){var s,u,c,l,f,p=/^(.+?)(\[.*\])$/;if(u=t.match(p)){l=u[1],c=u[2].replace(/^\[|\]$/g,"").split("][");for(var h=0;f=c[h];h++)s=!f||f.match(/^\d+$/),!l&&isArray(e)&&(l=e.length),n(e,l)||(e[l]=s?[]:{}),e=e[l],l=f;!l&&s&&(l=e.length.toString()),i(e,l,r,a)}else e[t]=a&&"true"===r?!0:a&&"false"===r?!1:a&&o.validate.number(r)?parseFloat(r,10):r}var o={};o.onServerError=function(e){alert(e||"unknown error")};var a=function(e,t){this.url=0===e.indexOf("http://")||0===e.indexOf("https://")?e:o.apiServer+e.replace(/^['\/']/,""),this.unlimited=!1,this.accessable=!0,this.type="text",this.timeout=1e4,this.name=t.split("$")[0],this.method=t.indexOf("$")>0?"POST":"GET"};a.prototype={toString:function(){return this.url},handleError:function(e){o.onServerError.call(this,e)},invoke:function(e,r){var n=this;return this.accessable||this.unlimited?(this.accessable=!1,t.isFunction(e)&&(r=e,e=null),t.ajax({url:this.url,data:e,dataType:this.type,timeout:this.timeout,type:this.method,beforeSend:function(){},complete:function(){n.accessable=!0,n=null},error:function(e,t,r){o.onServerError.call(n,r)},success:function(e,t,i){var a=JSON.parse(decodeURIComponent(decodeURIComponent(e)));"success"===a.statu?r&&"function"==typeof r&&r(a,t,i):o.onServerError.call(n,a.statu)}})):void 0}},o.api=function(e){for(var t in e){var r=t.split("$")[0];if(o.api[r])throw new Error("duplicate definition");o.api[r]=function(e){function t(t,r){return e.invoke.call(e,t,r)}return t.set=function(t,r){return e[t]=r,e},t.get=function(t){return e[t]},t}(new a(e[t],t))}return o.api},o.apiServer="{{apiServer}}",o.request=function(e,t){var r,n={};e=e&&e.toString?e.toString():"";for(var o,a=e.replace(/^.*?\?/,"").split("&"),s=0;o=a[s];s++)r=o.split("="),2===r.length&&i(n,r[0],decodeURIComponent(r[1]),t);return n}(e.location.search,!1),o.format={date:function(e,t){var r=t||"yyyy-MM-dd",n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours()>12?e.getHours()-12:e.getHours(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return r}},o.validate={date:function(e,t){var r=Date.parse(e);if(isFinite(r))return!0;if(t){var n=new Date;return e=e.replace(/\d{4}/,n.getFullYear()),r=Date.parse(e),isFinite(r)}return!1},email:function(e){return/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i.test(e)},mobile:function(e){return/^1[3|4|5|7|8]\d{9}$/.test(e)},phone:function(e){return/^\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})$/.test(e)},wx:function(){var t=e.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)}};var s=function(e){if("string"!=typeof e)return r;try{return JSON.parse(e)}catch(t){return e||r}},u=e.localStorage;o.store={use:function(t){return u=e[t||"localStorage"],store},get:function(e,t){var n=s(u.getItem(e));return n===r?t:n},set:function(e,t){return t!==r&&u.setItem(e,JSON.stringify(t)),t},remove:function(e){u.removeItem(e)},clear:function(){u.clear()},each:function(e){for(var t=0,r=u.length;r>t;t++){var n=u.key(t);e(n,store.get(n))}}},o.alert=function(e){alert(e)},e.zq=o}(window,Zepto);